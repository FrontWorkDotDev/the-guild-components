import { MDXRemote } from 'next-mdx-remote'
import { compileMdx } from 'nextra/compile'
import { fetchPackageInfo, Tabs, useData, useMDXComponents } from '@theguild/components'
import { defaultRemarkPlugins } from '@theguild/components/next.config'

export const getStaticProps = async () => {
  const PACKAGE_NAME = '@envelop/core'
  const { readme } = await fetchPackageInfo(PACKAGE_NAME)
  const mdx = await compileMdx(
    `
\`\`\`sh npm2yarn
npm i ${PACKAGE_NAME}
\`\`\`
${readme}`,
    {
      defaultShowCopyCode: true,
      mdxOptions: {
        remarkPlugins: defaultRemarkPlugins
      }
    }
  )
  return {
    props: {
      ssg: mdx.result
    },
    // Revalidate at most once every 1 hour
    revalidate: 60 * 60
  }
}

export const PackageApiDocs = () => {
  // Get the data from SSG, and render it as a component.
  const compiledSource = useData()
  const components = useMDXComponents()
  return <MDXRemote compiledSource={compiledSource} components={{ ...components, $Tabs: Tabs }} />
}

# Remote MDX Support

<PackageApiDocs />
